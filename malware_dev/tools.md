| ðŸ  [Home](../../pentesting.md) | â¬…ï¸ â¬…ï¸ [Part](../_part) | â¬…ï¸ [Chapter](./_chapter) |
|--------------------------------|----------------------|-------------------------|

-   [Tools](#tools){#toc-tools}
    -   [ThreatCheck](#threatcheck){#toc-threatcheck}

# Tools

## ThreatCheck

[ThreatCheck](https://github.com/rasta-mouse/ThreatCheck),
[PACHAKUTlQ/ThreatCheck](https://github.com/PACHAKUTlQ/ThreatCheck)
allow to locate which bytes trigger a detection

Need defender on, but `Real-time protection` and
`Automatic sample submission` are disabled and an exlusion is set for
the folder related to devlopment

Using the [x64 Native Tools Command
Prompt](https://learn.microsoft.com/en-us/visualstudio/ide/reference/command-prompt-powershell?view=vs-2022),
we can use
[msbuild](https://learn.microsoft.com/fr-fr/visualstudio/msbuild/walkthrough-using-msbuild?view=vs-2022)
to compile the project as it is:

    msbuild SharpWMI.sln /p:Configuration=Release /p:Platform="Any CPU" -restore -noLogo

The next step is to disable Windows Defender, copy the executable
outside the exclusion (usually a good idea to rename the executable),
and run ThreatCheck against it to determine which parts of the program
are detected as malicious.

    copy SharpWMI.exe \Temp\s.exe
    C:\Users\Public\tools\ThreatCheck\ThreatCheck\ThreatCheck\bin\x64\Release\ThreatCheck.exe -f c:\temp\s.exe

    visual studio installer => Modify on visual studio version => select workload to install:

    .Net desktop devlopemnt
    Universl Windows Platform development
    Desktop developelent with c++
